---
title: "u1939659_part2"
author: "Diallo"
date: "1 de diciembre de 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("dplyr")
```

```{r}
mostreig = function(.data, udg_id){
  set.seed(as.numeric(gsub("u", "", udg_id, fixed = TRUE)))
  .data %>%
    sample_n(100)
}
emex.mostra = emex.data %>%
  mostreig(udg_id = 'u1939659')
print(emex.mostra)
```
Feu una descriptiva numèrica i gràfica de la variable proporció de dones del municipi. (utilitzeu les variables amb codi t195 a la columna t.code del dataframe emex.desc). [1.5 punts]

```{r}
  Homes <- emex.mostra %>%
  select(mun,com,prov,ca,f320,f321) %>%
  group_by(com) %>%
  summarise(gender=sum(f320,na.rm = TRUE))
```

```{r}
  Dones <- emex.mostra %>%
  select(mun,com,prov,ca,f318,f321) %>%
  group_by(com) %>%
  summarise(gender=sum(f318,na.rm = TRUE))
```


```{r}
p <- ggplot(NULL, aes(com, gender)) + 
  geom_bar(aes(fill = "Homes"), data = Homes, alpha = 0.5,stat = "identity") +
  geom_bar(aes(fill = "Dones"), data =Dones, alpha = 0.5,stat = "identity")+
  coord_flip()
p
```


Repetiu les descriptives anteriors per Províncies. Comenteu-les. [1.5 punts]

```{r}
  HomesP <- emex.mostra %>%
  select(mun,com,prov,ca,f320,f321) %>%
  group_by(prov) %>%
  summarise(gender=sum(f320,na.rm = TRUE))
```

```{r}
  DonesP <- emex.mostra %>%
  select(mun,com,prov,ca,f318,f321) %>%
  group_by(prov) %>%
  summarise(gender=sum(f318,na.rm = TRUE))
```


```{r}
p <- ggplot(NULL, aes(prov, gender)) + 
  geom_bar(aes(fill = "Homes"), data = HomesP, alpha = 0.1,stat = "identity") +
  geom_bar(aes(fill = "Dones"), data =DonesP, alpha = 0.1,stat = "identity")+
  coord_flip()
p
```

El següent chunk crea un dataframe anomenat df.bestiar que conté una columna anomenada bestiar amb el tipus de bestiar més abundant al municipi. Descriviu aquest variable de forma numèrica i gràfica. Comenta el que obtinguis. [1.5 punts]

```{r}
library(tidyr)
bestiar = emex.desc %>%
  subset(t.code == 't140') %>%
  pull(f.desc)
lbestiar = emex.desc %>%
  subset(t.code == 't140') %>%
  pull(f.code) %>%
  lapply(identity) %>%
  setNames(bestiar)
df.bestiar = emex.mostra %>%
  select_vars(lbestiar) %>%
  gather(bestiar, n, -mun) %>%
  group_by(mun) %>%
  na.omit() %>%
  summarise(
    bestiar = bestiar[which.max(n)]
    )
```


Descriviu la variable anterior per províncies. (haureu d’afegir la informació de la comarca al dataframe df.bestiar). [1.5 punts]

Creieu que la variable densitat de població (f262) pot ser considerada exponencial? I normal? I si calculeu el logaritme d’aquesta variable, creieu que pot ser considerada normal? (A part de donar evidències estadístiques, mostra informació gràfica que ajudi a entendre la vostra resposta). [1.5 punts]

